"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2523],{74501:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(17674),u=r(67294);function o(e,t){var r=u.useState(e),o=(0,n.Z)(r,2),i=o[0],a=o[1];return u.useEffect((function(){var r=setTimeout((function(){a(e)}),t);return function(){clearTimeout(r)}}),[e]),i}},97203:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(90116),u=r(17674),o=r(67294),i=r(74501),a=r(59499);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s=function(e){return/\s/.test(e)};function f(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=o.useState(null),i=(0,u.Z)(n,2),a=i[0],c=i[1],f=o.useCallback(c,[c]),p=o.useRef(t);o.useEffect((function(){p.current=t}),[t]);var v=o.useState(null),d=(0,u.Z)(v,2),g=d[0],b=d[1];return o.useEffect((function(){if(a){var e=function(){var e=a.value,t=a.selectionStart;if(t){var r=1===t||s(e[t-2]||""),n=e.length?e[t-1]:null;b((function(u){if(u&&(t<u.index||0===t))return null;if(!n)return u;if(!u&&!r)return u;var o=p.current.includes(n);return u||o?u?s(n)?null:l(l({},u),{},{text:e.slice(u.index,t)}):{index:t,text:"",match:n}:u}))}else b(null)},t=function(){b(null)};return a.addEventListener("focus",e),a.addEventListener("keyup",e),a.addEventListener("blur",t),function(){b(null),a.removeEventListener("focus",e),a.removeEventListener("keyup",e),a.removeEventListener("blur",t)}}}),[a,b]),[g,f]}function p(e){var t=o.useRef(e);o.useEffect((function(){t.current=e}),[e]);var r=o.useState(!1),a=(0,u.Z)(r,2),c=a[0],l=a[1],s=o.useState(null),p=(0,u.Z)(s,2),v=p[0],d=p[1],g=f.apply(void 0,(0,n.Z)(Object.keys(e))),b=(0,u.Z)(g,2),h=b[0],m=b[1],y=o.useRef(h);o.useEffect((function(){y.current=h}),[h]);var Z=(0,i.Z)(h,100);return o.useEffect((function(){if(Z){var e=Z.match,r=Z.text,n=t.current[e]?t.current[e]:null;if(n){var u=!1;return l(!0),n(r).then((function(e){u||y.current===Z&&(l(!1),d({textTrigger:Z,results:e,applySuggestion:function(e){var t=e.targetValue,r=e.suggestionValue,n=t.slice(0,Z.index),u=r,o=t.slice(Z.index+Z.text.length);o&&o.startsWith(" ")||(u+=" ");var i=n+u+o;return{cursorIndex:(n+u).length+(o&&o.startsWith(" ")?1:0),fullValue:i}}}))})),function(){u=!0}}d(null)}else d(null)}),[Z,d]),[{isLoading:c,suggestions:v},m]}},69608:function(e,t,r){r.d(t,{Z:function(){return z},S:function(){return L}});var n=r(59499),u=r(50029),o=r(87794),i=r.n(o),a=r(67294),c=r(50988),l=r(93586),s=r(17674),f=r(16496),p=r.n(f),v=r(97203),d=r(88942);var g=r(85271),b=r(90116),h=r(76861),m=r(20159);function y(e){var t=e.initialValue,r=e.textTriggers,n=(0,a.useState)(t||""),o=n[0],c=n[1],f=(0,a.useRef)(null),y=function(e){var t=e.textTriggers,r=e.applySuggestion,n=(0,a.useRef)(null),u=(0,v.Z)(t),o=(0,s.Z)(u,2),i=o[0].suggestions,c=o[1],l=(0,d.Kb)({items:(null===i||void 0===i?void 0:i.results)||[],defaultHighlightedIndex:0,isOpen:Boolean(i),onSelectedItemChange:function(e){var t=e.selectedItem;if(i&&t){var u=n.current;if(u){var o=i.applySuggestion({targetValue:u.value,suggestionValue:t.value}),a=o.fullValue,c=o.cursorIndex;r({fullValue:a,cursorIndex:c})}}}}),f=(0,a.useMemo)((function(){if(i&&n.current)return p()(n.current,i.textTrigger.index)}),[i]);return{ref:(0,a.useCallback)((function(e){n.current=e,c(e)}),[c]),suggestions:null===i||void 0===i?void 0:i.results,caretCoordinates:f,combobox:l}}({textTriggers:r,applySuggestion:function(e){var t=e.cursorIndex,r=e.fullValue;c(r),setTimeout((function(){f.current&&f.current.setSelectionRange(t,t)}))}}),Z=y.combobox,O=y.caretCoordinates,x=y.suggestions,w=y.ref,C=function(e){var t=(0,a.useRef)(null),r=(0,l.Z)(e.onChange),n=(0,l.Z)(e.onError),o=(0,a.useCallback)((function(e){t.current=e}),[]),c=(0,a.useCallback)(function(){var e=(0,u.Z)(i().mark((function e(u){var o,a,c,l,s,f,p,v,d,g;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.current){e.next=3;break}return e.abrupt("return");case 3:return a=o.value,c=o.selectionStart?o.selectionStart:a.length,l=u.map((function(e){return"![Uploading ".concat(e.name,"...]()")})),s=a.substr(0,c),f=a.substr(c),p=(0,b.Z)(l),s&&p.unshift(s),f&&p.push(f),r.current(p.join("\n")),v=[],e.prev=13,e.next=16,(0,h.L0)(u);case 16:v=e.sent,e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(13),n.current(e.t0),e.abrupt("return");case 23:return d=[],e.prev=24,e.next=27,Promise.all(v.map((function(e){return(0,m.uz)("/data/images/upload",{image:e})})));case 27:d=e.sent,e.next=34;break;case 30:return e.prev=30,e.t1=e.catch(24),n.current(e.t1),e.abrupt("return");case 34:if(t.current){e.next=36;break}return e.abrupt("return");case 36:g=l.reduce((function(e,t,r){var n=u[r].name.replace(/\.[^/.]+$/,""),o=d[r],i=o instanceof Error?"Error uploading":o.url;return e.replace(t,"![".concat(n,"](").concat(i,")"))}),t.current.value),r.current(g);case 38:case"end":return e.stop()}}),e,null,[[13,19],[24,30]])})));return function(t){return e.apply(this,arguments)}}(),[r,n]),s=(0,a.useCallback)((function(e){var t=Array.from(e.clipboardData.items).filter((function(e){return"file"===e.kind})).map((function(e){return e.getAsFile()})).filter((function(e){return null!==e}));t.length&&c(t)}),[c]);return{ref:o,handleFiles:c,handlePaste:s}}({onChange:c,onError:function(){}}),j=C.handleFiles,P=C.handlePaste,k=C.ref,S=(0,g.Z)((function(e){null!==e&&j(e)})),E=(0,s.Z)(S,2)[1],D=(0,a.useCallback)((function(e){f.current=e,w(e),k(e)}),[w,k]),V=(0,a.useCallback)((function(e,t){var r;null===(r=f.current)||void 0===r||r.setSelectionRange(e,t)}),[]);return{ref:D,value:o,setValue:c,dropZoneHandlers:E,handlePaste:P,combobox:Z,caretCoordinates:O,suggestions:x,setSelectionRange:V}}var Z=r(70117),O=r(45786),x=r(86343),w=r(91462),C=r(23475),j=r(7344),P=r(2736),k=r(14907),S=r(35944);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=(0,P.K)("div"),I=(0,P.K)("li");function L(e){return R.apply(this,arguments)}function R(){return(R=(0,u.Z)(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.l){e.next=2;break}throw new Error("Expected apolloClient");case 2:return e.next=4,k.l.query({query:c.ofZ,variables:{query:t,limit:5}});case 4:return r=e.sent,n=r.data,e.abrupt("return",n.usernameSearch);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T={name:"bjn8wh",styles:"position:relative"},U={name:"1mzyfz7",styles:"position:relative;max-width:180px"};function z(e){var t,r=e.onChange,n=e.initialValue,o=e.autoFocus,c=e.placeholder,s=e.onKeyDown,f=e.onBlur,p=e.onFocus,v=e.userSearch,d=(0,a.useRef)(n),g=(0,l.Z)(r),b=function(e){var t=e.initialValue,r=e.userSearch,n=void 0===r?L:r,o=y({initialValue:t,textTriggers:{"@":function(){var e=(0,u.Z)(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:return r=e.sent,e.abrupt("return",r.map((function(e){return{icon:(0,S.tZ)(Z.Z,{alt:e.username,src:e.image,size:16}),value:e.username}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}});return o}({initialValue:n,userSearch:v}),h=b.setSelectionRange;return(0,O.Z)((function(){g.current(b.value)}),[b.value]),(0,a.useEffect)((function(){if(o&&d.current){var e=d.current.length;h(e,e)}}),[o,h]),(0,S.BX)(V,D(D({css:T},b.combobox.getComboboxProps()),{},{children:[(0,S.tZ)(x.B,D(D({},b.combobox.getInputProps({placeholder:c||"Write something about this post",ref:b.ref,onKeyDown:function(e){b.combobox.isOpen||"ArrowUp"!==e.key&&"ArrowDown"!==e.key||(e.nativeEvent.preventDownshiftDefault=!0),s&&s(e)},onBlur:f,onFocus:p,value:b.value,onChange:function(e){return b.setValue(e.currentTarget.value)},onPaste:b.handlePaste,autoFocus:o})),{},{css:[w.l0.width("100%"),"min-height:120px;resize:vertical;",""]})),(0,S.tZ)(V,D(D({},b.combobox.getMenuProps()),{},{css:["position:absolute;",b.caretCoordinates&&{top:b.caretCoordinates.top+b.caretCoordinates.height,left:b.caretCoordinates.left-4},"",""],children:null!==(t=b.suggestions)&&void 0!==t&&t.length?(0,S.tZ)(C.Z,{css:U,children:b.suggestions.map((function(e,t){return(0,S.tZ)(I,D(D({},b.combobox.getItemProps({item:e,index:t})),{},{children:(0,S.tZ)(j.Z,{title:e.value,selected:b.combobox.selectedItem===e,highlighted:b.combobox.highlightedIndex===t,icon:e.icon?(0,S.tZ)(P.Z,{children:e.icon}):void 0})}),e.value)}))}):null}))]}))}},86611:function(e,t,r){r.d(t,{W:function(){return d},Z:function(){return g}});var n=r(67294),u=r(55162),o=r(56276),i=r(5699),a=r(54838),c=r(2736),l=r(89788),s=r(80291),f=r(91462),p=r(5946),v=r(35944);function d(e){var t=(0,n.useState)(null),r=t[0],u=t[1],o=(0,n.useState)(null),i=o[0],c=o[1],l=(0,a.Z)({onUpload:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){var r=t.url;u(null),e(r)})),onUploadPreview:function(e){var t=e.dataUrl;c(null),u(t)},onError:function(e){u(null),c(e.message)}}),s=(0,n.useCallback)((function(){return c(null)}),[]);return{uploadImage:l.uploadImage,error:i,clearError:s,previewUrl:r}}function g(e){var t=(0,n.useRef)(null),r=e.size||48;return(0,v.BX)(c.Z,{css:[f.l0.position.relative,"cursor:pointer;&:hover .surface{opacity:0.8;}&:hover .icon{opacity:1;}",""],onClick:function(){var e;null===(e=t.current)||void 0===e||e.click()},"aria-label":e.value?"Change icon":"Upload an icon","data-microtip-position":"right",role:"tooltip",children:[e.value?(0,v.BX)(v.HY,{children:[(0,v.tZ)(u.Z,{iconUrl:e.value,size:e.size,alt:"icon"}),(0,v.tZ)(l.Z,{className:"surface",elevated:!0,css:[f.l0.borderRadius(8),f.l0.coverContainer,{opacity:e.isUploading?.8:0},"",""]}),(0,v.tZ)(c.Z,{className:"icon",css:[f.l0.coverContainer,f.l0.center,f.l0.color.accentPrimaryDefault,{overflow:"hidden",opacity:e.isUploading?1:0},"",""],children:e.isUploading?(0,v.tZ)(i.Z,{}):(0,v.tZ)(o.Z,{})})]}):(0,v.tZ)(c.Z,{css:[f.l0.center,f.l0.width(r),f.l0.height(r),f.l0.borderRadius(8),f.l0.color.foregroundDimmer,{border:"1px dashed "+f.TV.outlineDefault,"&:hover":{color:f.TV.accentPrimaryDefault,borderColor:f.TV.accentPrimaryDefault}},"",""],children:(0,v.tZ)(s.Z,{})}),(0,v.tZ)("input",{css:[[f.l0.coverContainer,{opacity:0,zIndex:-1}],"",""],ref:t,accept:p.W.join(","),type:"file",onChange:function(t){var r=t.target,n=r.validity,u=r.files;if(n.valid){var o=u?u[0]:null;o&&e.onUpload(o)}}})]})}},56276:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(59499),u=(r(67294),r(16082)),o=r(35944);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e){return(0,o.tZ)(u.Z,a(a({},e),{},{children:(0,o.tZ)("path",{d:"M17 3.0003C17.2626 2.73766 17.5744 2.52932 17.9176 2.38718C18.2608 2.24503 18.6286 2.17188 19 2.17188C19.3714 2.17187 19.7392 2.24503 20.0824 2.38718C20.4256 2.52932 20.7374 2.73766 21 3.0003C21.2626 3.26295 21.471 3.57475 21.6131 3.91791C21.7553 4.26107 21.8284 4.62887 21.8284 5.0003C21.8284 5.37174 21.7553 5.73953 21.6131 6.08269C21.471 6.42585 21.2626 6.73766 21 7.0003L7.5 20.5003L2 22.0003L3.5 16.5003L17 3.0003Z",strokeLinecap:"round",strokeLinejoin:"round"})}))}}}]);
//# sourceMappingURL=2523-05dad199cc76cd7a.js.map