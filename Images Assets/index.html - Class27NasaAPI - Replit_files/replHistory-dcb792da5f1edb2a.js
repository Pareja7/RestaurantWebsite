(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5989],{15938:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/replHistory",function(){return r(38692)}])},62026:function(e,t,r){"use strict";r.d(t,{Z:function(){return R}});var n=r(35944),i=r(65988),o=r.n(i),a=r(67294),s=r(45697),l=r.n(s);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners=[]}var t,r,n;return t=e,(r=[{key:"listenOnce",value:function(e,t,r){if(this._listeners.push([e,t,r]),!e.once)throw new Error("Target does not allow once");e.once(t,r)}},{key:"listen",value:function(e,t,r){this._listeners.push([e,t,r]),e.on?e.on(t,r):e.addListener?e.addListener(t,r):e.addEventListener&&e.addEventListener(t,r)}},{key:"destroy",value:function(){this._listeners.forEach((function(e){var t=f(e,3),r=t[0],n=t[1],i=t[2];r.removeListener?r.removeListener(n,i):r.removeEventListener&&r.removeEventListener(n,i)}))}}])&&u(t.prototype,r),n&&u(t,n),e}(),p=r(51281);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function x(e,t){return!t||"object"!==w(t)&&"function"!==typeof t?y(e):t}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(l){s=!0,i=l}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return x(this,r)}}var R=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(l,e);var t,r,i,s=E(l);function l(){var e;return m(this,l),v(y(e=s.apply(this,arguments)),"onSubmit",(function(t){e.props.hideOnSubmit&&e.props.hideModal&&e.props.hideModal(),e.props.onSubmit(t)})),v(y(e),"getBodyAndTitle",(function(){var t=e.props.children;if(!Array.isArray(t)&&a.Children.count(t)<2)throw new Error("Expected title and body in ActionModal");var r=t[0];if(Array.isArray(r))throw new Error("title child cannot be an array");var n=a.cloneElement(r,{className:"action-modal-title "+("undefined"!==typeof r.className?r.className:"")}),i=t[1];if(Array.isArray(i))throw new Error("body child cannot be an array");return[n,a.cloneElement(i,{className:"action-modal-body"+(i.className||"")})]})),e}return t=l,(r=[{key:"componentDidMount",value:function(){var e=this;this._eventSubscriber=new d,this._eventSubscriber.listen(window.document,"keydown",(function(t){13!==t.keyCode||e.props.submitWithoutCtrl&&!t.ctrlKey&&!t.metaKey||e.props.disableSubmit||e.props.onSubmit()}))}},{key:"componentWillUnmount",value:function(){this._eventSubscriber&&this._eventSubscriber.destroy(),this._eventSubscriber=null}},{key:"render",value:function(){var e=this,t=S(this.getBodyAndTitle(),2),r=t[0],i=t[1];return(0,n.BX)("div",{style:this.props.modalStyle,className:"jsx-e123268722070cea action-modal",children:[(0,n.tZ)(o(),{id:"2e0b82346f09e44d",children:".action-modal.jsx-e123268722070cea{color:var(--foreground-default)}"}),(0,n.tZ)(o(),{id:"bcde05e0780dcb77",children:".action-modal.jsx-e123268722070cea{padding:35px 25px 35px;display:grid;grid-row-gap:var(--space-16)}.action-modal-buttons.jsx-e123268722070cea{display:grid;grid-row-gap:var(--space-8)}.action-modal.jsx-e123268722070cea .action-modal-title{font-size:20px}.action-modal.jsx-e123268722070cea .action-modal-body{font-size:16px;padding-top:30px;line-height:22px}@media screen and (min-width:400px){.action-modal-buttons.jsx-e123268722070cea{grid-auto-flow:column;grid-column-gap:20px;-webkit-justify-content:start;justify-content:start}.action-modal-buttons.jsx-e123268722070cea>button:first-child{-webkit-order:1;-ms-flex-order:1;order:1}}@media screen and (min-width:600px){.action-modal.jsx-e123268722070cea{padding:75px 50px 75px}}"}),r,i,(0,n.BX)("div",{className:"jsx-e123268722070cea action-modal-buttons",children:[(0,n.tZ)(p.Z,{color:this.props.deleteStyle?"negative":"primary",disabled:this.props.disableSubmit,onClick:this.onSubmit,filled:!0,children:this.props.submitLabel||"Ok"},"actionModalCta"),!this.props.hideCancel&&(0,n.tZ)(p.Z,{onClick:function(){e.props.onCancel&&e.props.onCancel(),e.props.hideModal&&e.props.hideModal()},children:this.props.cancelLabel||"Cancel"},"cancel")]})]})}}])&&b(t.prototype,r),i&&b(t,i),l}(a.Component);v(R,"propTypes",{hideModal:l().func.isRequired}),v(R,"defaultProps",{autoFocus:!1})},63431:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var n=r(34051),i=r.n(n),o=r(54098),a=r.n(o),s=r(31917);function l(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,i)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){l(o,n,i,a,s,"next",e)}function s(e){l(o,n,i,a,s,"throw",e)}a(void 0)}))}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){u(e,t,r[t])}))}return e}function d(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;function h(e){return y.apply(this,arguments)}function y(){return(y=c(i().mark((function e(t){var r,n,o,l,c,u,h,y;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,n=d(t,["url"]),e.prev=2,e.next=5,a()(r,{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},method:"post",body:JSON.stringify(f({},n,{format:"pbuf"}))});case 5:o=e.sent,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),e.t0.statusCode=504,e.t0;case 12:if(o.ok){e.next=28;break}if(!(c=o.headers.get("content-type"))||!c.includes("application/json")){e.next=22;break}return e.next=18,o.json();case 18:u=e.sent,l=u.message,e.next=25;break;case 22:return e.next=24,o.text();case 24:l=e.sent;case 25:throw(h=new Error(l||o.statusText)).statusCode=o.status,h;case 28:return e.next=30,o.json();case 30:if((y=e.sent).token.startsWith("v2.public.")||p.test(y.token)){e.next=33;break}throw new s.default("Expected token to be PASETO- or base64-encoded").setExtras(f({connectionMetadata:y,url:r},n));case 33:return e.abrupt("return",y);case 34:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}},36526:function(e,t,r){"use strict";var n=r(34051),i=r.n(n),o=r(48010);function a(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(n,i)}t.Z=function(){var e,t=(e=i().mark((function e(t,r){var n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}n=t.user,e.next=14;break;case 5:if(!((a=r.getState().user)&&a.userInfo.isLoggedIn&&a.userInfo)){e.next=10;break}n=a.userInfo,e.next=14;break;case 10:return e.next=12,(0,o.LK)("/is_authenticated");case 12:(s=e.sent).success&&(n=s.user);case 14:return n&&(t&&(n=JSON.parse(JSON.stringify(n))),r.dispatch({type:"FETCH_USER_INFO_SUCCESS",user:n})),e.abrupt("return",{user:n});case 16:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,l,"next",e)}function l(e){a(o,n,i,s,l,"throw",e)}s(void 0)}))});return function(e,r){return t.apply(this,arguments)}}()},98555:function(e,t,r){"use strict";r.d(t,{rM:function(){return h},G5:function(){return y},h$:function(){return m}});var n=r(56869),i=r.n(n),o=r(2466),a=r.n(o),s=r(44119),l=r.n(s),c=r(87152);function u(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function f(){var e,t,r=(e=["\n  mutation ReduxUpdateReplMutation($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        title\n        description\n        language\n        url\n        config {\n          isServer\n          isVnc\n        }\n        isPrivate\n        isStarred\n      }\n    }\n  }\n"],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return f=function(){return r},r}function d(e){if(Array.isArray(e))return e.map(d);if(e&&"object"===typeof e){var t={};for(var r in e)t[a()(r)]=e[r];return t}return"string"===typeof e?a()(e):e}var p=l()(f());function h(e,t){return function(r){r({type:"UPDATE_REPL_REQUEST",id:e,updates:t});var n=d(t);if(Array.isArray(n)||"string"===typeof n)throw new Error("Repl updates should be an object");var i=t.config,o=u(t,["config"]);i&&("undefined"!==typeof i.isServer&&(o.isServer=i.isServer),"undefined"!==typeof i.isVnc&&(o.isVnc=i.isVnc)),o.id=e,c.l.mutate({mutation:p,variables:{input:o}}).then((function(t){var n=t.data,i=t.errors;i&&i.length||!n.updateRepl||!n.updateRepl.repl?r({type:"UPDATE_REPL_FAILURE",id:e}):r({type:"UPDATE_REPL_SUCCESS",repl:n.updateRepl.repl})}))}}function y(e){return function(t){return t({type:"UPDATE_REPL_SUCCESS",repl:e})}}function m(e){return{type:"FETCH_REPL_SUCCESS",repl:i()(e)}}},94185:function(e,t,r){"use strict";var n=r(81548),i=r(55982);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}function l(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.Z.register("repls",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_REPL_SUCCESS":return s({},e,{data:s({},e.data,a({},t.repl.id,t.repl))});case"UPDATE_REPL_SUCCESS":return s({},e,{data:s({},e.data,a({},t.repl.id,s({},e.data[t.repl.id],t.repl)))});case"ENSURE_FILE":var r=(0,i.Uo)(t.path),n=(0,i.Xp)(t.path),o=e.data[r];return!o||o.fileNames.includes(n)?e:s({},e,{data:s({},e.data,a({},r,s({},o,{fileNames:l(o.fileNames).concat([n])})))});case"MOVE_FILE_SUCCESS":var c=(0,i.Uo)(t.to),u=e.data[c];if(!u||c!==(0,i.Uo)(t.from))return e;var f=(0,i.Xp)(t.from),d=(0,i.Xp)(t.to);return s({},e,{data:s({},e.data,a({},c,s({},u,{fileNames:l(u.fileNames.filter((function(e){return e!==f}))).concat([d])})))});case"DELETE_FILE_SUCCESS":var p=(0,i.Uo)(t.path),h=(0,i.Xp)(t.path),y=e.data[p];return y?s({},e,{data:s({},e.data,a({},p,s({},y,{fileNames:y.fileNames.filter((function(e){return e!==h}))})))}):e}return e})),n.Z.register("replsByUrl",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_REPL_SUCCESS":case"FETCH_REPL_SUCCESS":return s({},e,a({},t.repl.url,t.repl.id))}return e})),n.Z.register("replsByUser",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"FETCH_REPL_SUCCESS"===t.type?e[t.repl.userId]&&e[t.repl.userId].includes(t.repl.id)?e:s({},e,a({},t.repl.userId,(e[t.repl.userId]||[]).concat([t.repl.id]))):e}))},71291:function(e,t,r){"use strict";var n=r(48764).Buffer;function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}var s=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"asEncoding",{}),o(this,"asBuffer",null),r&&"string"===typeof t)this.asEncoding[r]=t;else if(void 0===t||null===t)this.asBuffer=n.alloc(0);else if(a(t,n))this.asBuffer=t;else if("string"===typeof t)this.asEncoding.utf8=t;else if(a(t,ArrayBuffer))this.asBuffer=n.from(t);else{if(a(t,e))return t;a(t,Uint8Array)?this.asBuffer=n.from(t):"object"!==typeof t||"object"!==typeof t.asEncoding||null===t.asEncoding||!a(t.asBuffer,n)&&null!==t.asBuffer||(this.asBuffer=t.asBuffer||null,"string"===typeof t.asEncoding.base64&&(this.asEncoding={base64:t.asEncoding.base64}),"string"===typeof t.asEncoding.utf8&&(this.asEncoding={utf8:t.asEncoding.utf8}))}}var t,r,s;return t=e,r=[{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";if(void 0!==this.asEncoding[e])return this.asEncoding[e];var t=this.toBuffer(),r=t.toString(e);return this.asEncoding[e]=r,r}},{key:"toJSON",value:function(){return{asEncoding:{base64:this.toString("base64")},asBuffer:null}}},{key:"length",get:function(){return void 0!==this.asEncoding.utf8?this.asEncoding.utf8.length:this.toBuffer().length}},{key:"toBuffer",value:function(){if(this.asBuffer)return this.asBuffer;for(var e in this.asEncoding){var t=this.asEncoding[e];if("string"===typeof t){var r=n.from(t,e);return this.asBuffer=r,r}}return this.asBuffer=n.alloc(0),this.asBuffer}}],s=[{key:"from",value:function(t,r){return new e(t,r)}},{key:"isBuffer",value:function(t){return a(t,e)}}],r&&i(t.prototype,r),s&&i(t,s),e}();t.Z=s},38692:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Re}});var n=r(34051),o=r.n(n),a=r(35944),s=r(65988),l=r.n(s),c=(r(94185),r(62067)),u=r(81548);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){var t=d(e.split("/")),r=t[0],n=t.slice(1),i=encodeURIComponent(n.join("/"));return"".concat(r,"/").concat(i)}function h(e,t){return"".concat(e,"/").concat(t)}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){y(e,t,r[t])}))}return e}u.Z.register("replHistoryByFile",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_LATEST_REPL_FILE_REVISION_PER_DAY_REQUEST":return m({},e,y({},t.meta.filePath,m({},e[t.meta.filePath],{fetchState:"fetching"})));case"FETCH_LATEST_REPL_FILE_REVISION_PER_DAY_SUCCESS":return m({},e,y({},t.meta.filePath,{fetchState:"done",days:Object.keys(t.payload).map((function(e){return h(t.meta.filePath,e)})),revisions:Object.values(t.payload).map((function(e){return e.revisions[0].generation}))}));case"FETCH_LATEST_REPL_FILE_REVISION_PER_DAY_FAILURE":return m({},e,y({},t.meta.filePath,m({},e[t.meta.filePath],{fetchState:"error"})));case"FETCH_ALL_REPL_FILE_REVISIONS_PER_DAY_SUCCESS":return m({},e,y({},t.meta.filePath,m({},e[t.meta.filePath],{revisions:t.payload.map((function(e){return e.generation}))})))}return e})),u.Z.register("replHistoryByDay",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_LATEST_REPL_FILE_REVISION_PER_DAY_SUCCESS":return m({},e,Object.keys(t.payload).reduce((function(e,r){var n=t.payload[r];return e[h(t.meta.filePath,r)]={fetchState:"idle",expandable:n.expandable,revisions:n.revisions.map((function(e){return e.generation}))},e}),{}));case"FETCH_ALL_REPL_FILE_REVISIONS_PER_DAY_REQUEST":var r=h(t.meta.filePath,t.meta.day);return m({},e,y({},r,m({},e[r],{fetchState:"fetching"})));case"FETCH_ALL_REPL_FILE_REVISIONS_PER_DAY_SUCCESS":var n=h(t.meta.filePath,t.meta.day);return m({},e,y({},n,m({},e[n],{expandable:!0,fetchState:"done",revisions:t.payload.map((function(e){return e.generation}))})));case"FETCH_ALL_REPL_FILE_REVISIONS_PER_DAY_FAILURE":var i=h(t.meta.filePath,t.meta.day);return m({},e,y({},i,m({},e[i])))}return e})),u.Z.register("replHistory",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_LATEST_REPL_FILE_REVISION_PER_DAY_SUCCESS":return m({},e,Object.values(t.payload).reduce((function(e,t){var r=t.revisions[0];return e[r.generation]=r,e}),{}));case"FETCH_ALL_REPL_FILE_REVISIONS_PER_DAY_SUCCESS":return m({},e,(0,c.Z)(t.payload,"generation"))}return e}));var b=r(67294),v=r(12918),g=r(5152),x=r(11163),_=r(14890),S=r(78135),w=r(48010),E=r(92298),R=r(66970),j=r(45193),P=r(62026);function O(e){return(0,a.BX)("div",{className:"jsx-29e54fe40fd6f60d",children:[(0,a.tZ)(l(),{id:"29e54fe40fd6f60d",children:".HistorySideBar__fileNameHeader.jsx-29e54fe40fd6f60d{padding:25px 12px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-justify-content:space-around;justify-content:space-around;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.HistorySideBar__fileName.jsx-29e54fe40fd6f60d{font-size:23px;max-width:200px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.HistorySideBar__showFileSelector.jsx-29e54fe40fd6f60d{font-size:13px;margin-left:5px}"}),(0,a.BX)("div",{className:"jsx-29e54fe40fd6f60d HistorySideBar__fileNameHeader",children:[(0,a.tZ)("div",{className:"jsx-29e54fe40fd6f60d HistorySideBar__fileName",children:(0,a.tZ)("span",{className:"jsx-29e54fe40fd6f60d",children:e.fileName})}),(0,a.tZ)("div",{className:"jsx-29e54fe40fd6f60d HistorySideBar__showFileSelector",children:(0,a.tZ)("a",{onClick:e.onShowFileSelector,className:"jsx-29e54fe40fd6f60d",children:"change file"})})]}),e.fileHistory]})}var k=r(94184),I=r.n(k),C=r(61261);function F(e){return(0,a.BX)("div",{onClick:function(){return e.onSelectRevision(e.revision)},className:"jsx-71054e45e7430a76 "+(I()({HistoryRevisionItem__revisionItem:!0,"HistoryRevisionItem__revisionItem--selected":e.isSelected,"HistoryRevisionItem__revisionItem--child":e.isChild})||""),children:[(0,a.tZ)(l(),{id:"71054e45e7430a76",children:".HistoryRevisionItem__revisionItem.jsx-71054e45e7430a76{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:50px;width:100%;cursor:pointer}.HistoryRevisionItem__revisionItem--selected.jsx-71054e45e7430a76{color:var(--accent-primary-stronger);background-color:var(--background-higher)}.HistoryRevisionItem__revisionItem.jsx-71054e45e7430a76:hover{color:var(--accent-primary-default);background-color:var(--background-highest);text-decoration:underline}.HistoryRevisionItem__circle.jsx-71054e45e7430a76{position:relative;margin-left:10px;border:2px solid var(--outline-default);-webkit-border-radius:20px;-moz-border-radius:20px;border-radius:20px;display:inline-block}.HistoryRevisionItem__revisionItem--child.jsx-71054e45e7430a76 .HistoryRevisionItem__circle.jsx-71054e45e7430a76{margin-left:30px}.HistoryRevisionItem__innerCircle.jsx-71054e45e7430a76{-webkit-border-radius:30px;-moz-border-radius:30px;border-radius:30px;border:2px solid var(--background-default);height:18px;width:18px}.HistoryRevisionItem__revisionItem--child.jsx-71054e45e7430a76 .HistoryRevisionItem__innerCircle.jsx-71054e45e7430a76{height:13px;width:13px}.HistoryRevisionItem__circle--selected.jsx-71054e45e7430a76 .HistoryRevisionItem__innerCircle.jsx-71054e45e7430a76{background-color:var(--accent-primary-dimmer)}.HistoryRevisionItem__connection.jsx-71054e45e7430a76{position:absolute;border-right:2px solid var(--outline-default);height:30px;left:8px}.HistoryRevisionItem__connection--expanded.jsx-71054e45e7430a76{height:70px}.HistoryRevisionItem__connection--expandable.jsx-71054e45e7430a76{height:70px}.HistoryRevisionItem__revisionItem--child.jsx-71054e45e7430a76 .HistoryRevisionItem__connection.jsx-71054e45e7430a76{height:40px;left:5.5px}.HistoryRevisionItem__parentConnector.jsx-71054e45e7430a76{position:absolute;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;border-bottom:2px solid var(--outline-default);border-left:2px solid var(--outline-default);height:10px;width:13px;top:86px;left:8px}.HistoryRevisionItem__parentConnector--nextParent.jsx-71054e45e7430a76{top:5px;left:-12px;height:41px;-webkit-transform:scaleY(-1);-moz-transform:scaleY(-1);-ms-transform:scaleY(-1);-o-transform:scaleY(-1);transform:scaleY(-1)}.HistoryRevisionItem__revisionDate.jsx-71054e45e7430a76{margin-left:10px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}"}),(0,a.BX)("div",{className:"jsx-71054e45e7430a76 "+(I()({HistoryRevisionItem__circle:!0,"HistoryRevisionItem__circle--selected":e.isSelected})||""),children:[(0,a.tZ)("div",{className:"jsx-71054e45e7430a76 HistoryRevisionItem__innerCircle"}),(!e.isLast||!e.isChild&&e.isParentExpanded)&&(0,a.tZ)("div",{className:"jsx-71054e45e7430a76 "+(I()({HistoryRevisionItem__connection:!0,"HistoryRevisionItem__connection--expandable":e.isParentExpandable,"HistoryRevisionItem__connection--expanded":e.isParentExpanded})||"")}),!e.isChild&&e.isParentExpanded&&(0,a.tZ)("div",{className:"jsx-71054e45e7430a76 HistoryRevisionItem__parentConnector"}),e.isChild&&e.isLast&&!e.isParentLast&&e.isParentExpanded&&(0,a.tZ)("div",{className:"jsx-71054e45e7430a76 HistoryRevisionItem__parentConnector HistoryRevisionItem__parentConnector--nextParent"})]}),(0,a.tZ)("span",{className:"jsx-71054e45e7430a76 HistoryRevisionItem__revisionDate",children:(0,C.Z)(new Date(e.revision.timeCreated),"MMM dd, yyyy hh:mm aa")})]})}function N(e){return(0,a.BX)("div",{className:"jsx-542e0db3f7b2e53f",children:[(0,a.tZ)(l(),{id:"542e0db3f7b2e53f",children:".HistoryRevisionDay__parentWrapper--selected.jsx-542e0db3f7b2e53f{background-color:var(--background-higher)}.HistoryRevisionDay__parentWrapper.jsx-542e0db3f7b2e53f:hover{background-color:var(--background-higher)}.HistoryRevisionDay__expandWrapper.jsx-542e0db3f7b2e53f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;cursor:pointer;padding:10px 0;margin-left:20px;font-size:14px}.HistoryRevisionDay__expandWrapper.jsx-542e0db3f7b2e53f:hover{color:var(--accent-primary-stronger);text-decoration:underline}.HistoryRevisionDay__arrowRight.jsx-542e0db3f7b2e53f{width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:5px solid var(--accent-foreground-default);margin:0 10px 3px 20px}.HistoryRevisionDay__expandWrapper.jsx-542e0db3f7b2e53f:hover .HistoryRevisionDay__arrowRight.jsx-542e0db3f7b2e53f{border-left:5px solid var(--accent-primary-stronger)}.HistoryRevisionDay__arrowRight--open.jsx-542e0db3f7b2e53f{-webkit-transform:rotate(90deg);-moz-transform:rotate(90deg);-ms-transform:rotate(90deg);-o-transform:rotate(90deg);transform:rotate(90deg)}"}),(0,a.BX)("div",{className:"jsx-542e0db3f7b2e53f "+(I()({HistoryRevisionDay__parentWrapper:!0,"HistoryRevisionDay__parentWrapper--selected":e.parentRevision.generation===e.selectedRevisionGen})||""),children:[(0,a.tZ)(F,{onSelectRevision:e.onSelectRevision,revision:e.parentRevision,isSelected:e.parentRevision.generation===e.selectedRevisionGen,isParentExpanded:e.showRest,isParentExpandable:e.isExpandable,isLast:e.isLast},e.parentRevision.name+e.parentRevision.generation),e.isExpandable&&(0,a.BX)("div",{onClick:e.onToggleExpandDay,className:"jsx-542e0db3f7b2e53f HistoryRevisionDay__expandWrapper",children:[(0,a.tZ)("div",{className:"jsx-542e0db3f7b2e53f "+(I()({HistoryRevisionDay__arrowRight:!0,"HistoryRevisionDay__arrowRight--open":e.showRest})||"")}),(0,a.tZ)("div",{className:"jsx-542e0db3f7b2e53f",children:e.showRest?"collapse day":"expand day"})]})]}),e.isLoading&&(0,a.tZ)(R.Z,{style:{margin:"10px auto"}}),!e.isLoading&&e.showRest&&e.restRevisions.map((function(t,r,n){return(0,a.tZ)(F,{onSelectRevision:e.onSelectRevision,revision:t,isSelected:t.generation===e.selectedRevisionGen,isChild:!0,isParentExpanded:e.showRest,isParentExpandable:e.isExpandable,isLast:r===n.length-1,isParentLast:e.isLast},t.name+t.generation)}))]})}function L(e){return(0,a.BX)("div",{className:"jsx-da047a6ba702d325 FileSelector__fileSelector",children:[(0,a.tZ)(l(),{id:"da047a6ba702d325",children:".FileSelector__fileSelector.jsx-da047a6ba702d325{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-justify-content:space-around;justify-content:space-around;-webkit-align-items:baseline;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;font-size:17px}.FileSelector__header.jsx-da047a6ba702d325{padding:25px 30px;font-size:23px;width:100%;border-bottom:1px solid var(--outline-dimmest)}.FileSelector__fileItem.jsx-da047a6ba702d325{padding:16px 24px;line-height:1.3em;width:100%;cursor:pointer;border-bottom:1px solid var(--outline-dimmest);white-space:wrap;wrap:break-word}.FileSelector__fileItem--selected.jsx-da047a6ba702d325{color:var(--accent-primary-dimmer);background-color:var(--background-highest)}.FileSelector__fileItem.jsx-da047a6ba702d325:hover{color:var(--accent-primary-dimmest);background-color:var(--background-higher)}"}),(0,a.tZ)("div",{className:"jsx-da047a6ba702d325 FileSelector__header",children:"Select a file"}),e.fileNames.map((function(t){return(0,a.tZ)("div",{onClick:function(){return e.handleSelectFile(t)},className:"jsx-da047a6ba702d325 "+(I()({FileSelector__fileItem:!0,"FileSelector__fileItem--selected":t===e.selectedFileName})||""),children:t},"fileSelector"+t)}))]})}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){D(e,t,r[t])}))}return e}function M(e,t){return!t||"object"!==V(t)&&"function"!==typeof t?A(e):t}function z(e,t){return z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},z(e,t)}function X(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function Y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=T(e);if(t){var i=T(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return M(this,r)}}var q=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(o,e);var t,r,n,i=Y(o);function o(){var e;return Z(this,o),D(A(e=i.apply(this,arguments)),"state",{revisionDayStatus:{},showFileSelector:!1,isLoadingFileRevisions:!1}),D(A(e),"handleShowFileSelector",(function(){return e.setState({showFileSelector:!0})})),D(A(e),"handleSelectFile",(function(t){e.setState({showFileSelector:!1,revisionDayStatus:{},isLoadingFileRevisions:!0}),e.props.onSelectFile(t).then((function(t){var r=t.fetchState;e.setState({isLoadingFileRevisions:"fetching"===r})}))})),D(A(e),"handleToggleExpandDay",(function(t){var r=t.generation,n=t.timeCreated,i=e.state.revisionDayStatus,o=i[r];o&&"collapsed"!==o?e.setState({revisionDayStatus:U({},i,D({},r,"collapsed"))}):(e.setState({revisionDayStatus:U({},i,D({},r,"loading"))}),e.props.onExpandDay(n).then((function(){var t=e.state.revisionDayStatus,n="collapsed"===t[r]?"collapsed":"expanded";e.setState({revisionDayStatus:U({},t,D({},r,n))})})))})),D(A(e),"renderRevisionDay",(function(t,r,n){var i=e.props.historyByDay[r],o=X(i.revisions.map((function(t){return e.props.replHistory[t]}))),s=o[0],l=o.slice(1),c=e.state.revisionDayStatus[s.generation];return(0,a.tZ)(N,{parentRevision:s,restRevisions:l,isExpandable:i.expandable,isLoading:"loading"===c,isLast:r===n.length-1,showRest:"expanded"===c,selectedRevisionGen:e.props.selectedRevisionGen,onSelectRevision:e.props.onSelectRevision,onToggleExpandDay:function(){return e.handleToggleExpandDay(s)}},"day"+s.name+s.generation)})),e}return t=o,(r=[{key:"render",value:function(){if(this.state.showFileSelector)return(0,a.tZ)(L,{fileNames:this.props.repl.fileNames,selectedFileName:this.props.selectedFileName,handleSelectFile:this.handleSelectFile});var e,t=this.props.selectedFileName;return e=this.state.isLoadingFileRevisions||"done"!==this.props.historyByFile.fetchState?(0,a.tZ)(R.Z,{style:{margin:"10px auto"}}):this.props.historyByFile.days.map(this.renderRevisionDay),(0,a.tZ)(O,{fileName:t,onShowFileSelector:this.handleShowFileSelector,fileHistory:e})}}])&&B(t.prototype,r),n&&B(t,n),o}(b.Component),G=(0,S.$j)((function(e,t){var r=e.replHistoryByFile[t.repl.id+"/"+t.selectedFileName],n="done"===r.fetchState?r.days.map((function(t){return e.replHistoryByDay[t]})):[];return{historyByFile:r,historyByDay:n,replHistory:e.replHistory}}))(q);function W(e){var t=e.filePath,r=e.ssrFetch,n=e.force;return function(e,i){var o=i().replHistoryByFile[t];if(!n&&o){var a=o.fetchState;if("fetching"===a||"done"===a)return Promise.resolve({fetchState:a})}var s="/data/repls/".concat(p(t),"/history");return e({type:"FETCH_LATEST_REPL_FILE_REVISION_PER_DAY",payload:{promise:r?r(s,{normalize:!0}):(0,w.LK)(s)},meta:{filePath:t}})}}function $(e){var t=e.filePath,r=e.day;return function(e,n){var i=n().replHistoryByDay[h(t,r)];if(i){var o=i.fetchState;if("fetching"===o||"done"===o)return Promise.resolve({fetchState:o})}var a="".concat(r,"T00:00:00.000Z");return e({type:"FETCH_ALL_REPL_FILE_REVISIONS_PER_DAY",payload:{promise:(0,w.LK)("/data/repls/".concat(p(t),"/history/day/").concat(a))},meta:{filePath:t,day:r}})}}var K=r(67718),J=r(98555),Q=r(36526),ee=r(27740),te=r.n(ee),re=r(57171),ne=r(69824),ie=r.n(ne),oe=r(71291),ae=r(31917),se=r(63431);function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(v){return void r(v)}s.done?t(l):Promise.resolve(l).then(n,i)}function ue(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){ce(o,n,i,a,s,"next",e)}function s(e){ce(o,n,i,a,s,"throw",e)}a(void 0)}))}}function fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},he(e)}function ye(e,t){return!t||"object"!==be(t)&&"function"!==typeof t?le(e):t}function me(e,t){return me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},me(e,t)}var be=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=he(e);if(t){var i=he(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ye(this,r)}}function ge(){var e,t,r=(e=["/login?goto=",""],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return ge=function(){return r},r}var xe=(0,g.default)(ue(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([r.e(3662),r.e(5742),r.e(364),r.e(4025)]).then(r.bind(r,37085)));case 1:case"end":return e.stop()}}),e)}))),{loadableGenerated:{webpack:function(){return[37085]}},loading:function(){return(0,a.tZ)(R.Z,{style:{margin:"25px auto"}})},ssr:!1});function _e(e){var t=Math.floor(500*Math.random()),r=1e3*Math.pow(1.7,e);return Math.min(r,15e3)+t}function Se(e){return we.apply(this,arguments)}function we(){return we=ue(o().mark((function e(t){var r,n,i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.client,n=t.repl,i={connectionMetadata:void 0,timeout:1e4,pollingHost:void 0},a=0,s=0,l=function(){var e=ue(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e()}),_e(s))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();case 5:if(!1!==r.isConnected()){e.next=35;break}return e.prev=6,e.next=9,(0,se.Z)({url:"/data/repls/".concat(n.id,"/get_connection_metadata"),clientVersion:"b88ffe5"});case 9:i.connectionMetadata=e.sent,e.next=18;break;case 12:return e.prev=12,e.t0=e.catch(6),s++,e.next=17,l();case 17:return e.abrupt("continue",5);case 18:return e.prev=18,e.next=21,r.connect(i);case 21:e.next=33;break;case 23:if(e.prev=23,e.t1=e.catch(18),!e.t1.message.includes("Client.close")){e.next=27;break}return e.abrupt("return");case 27:return 2!==a||i.pollingHost||(i.pollingHost="gp-v2.replit.com"),a++,s++,e.next=32,l();case 32:return e.abrupt("continue",5);case 33:e.next=5;break;case 35:case"end":return e.stop()}}),e,null,[[6,12],[18,23]])}))),we.apply(this,arguments)}var Ee=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(s,e);var t,r,n,i=ve(s);function s(){var e;fe(this,s),pe(le(e=i.apply(this,arguments)),"state",{selectedFileName:e.props.initialFileName,selectedRevision:null,diff:"",diffPromise:null,modalName:"hidden"}),pe(le(e),"throwRestoreError",(function(e){throw new ae.default(e).setTag("source","history")}));var t=le(e);pe(le(e),"restoreReplFileGeneration",function(){var e=ue(o().mark((function e(r){var n,i,a,s,l,c,u,f,d,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.repl,i=r.filePath,a=r.generation,s="",e.prev=2,e.next=5,(0,w.LK)("/data/repls/".concat(n.id,"/").concat(encodeURIComponent(i),"/revision/").concat(a));case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),t.throwRestoreError(e.t0.message);case 11:return l=new re.KU,c=function(){l.isConnected()&&l.close()},e.next=15,Se({client:l,repl:n,isLoggedIn:!0});case 15:return l.isConnected()||t.throwRestoreError("goval failed to connect"),u=l.openChannel({service:"gcsfiles"}),e.next=19,u.request({write:{path:i,content:oe.Z.from(s,"base64").toBuffer()}});case 19:if(!(f=e.sent).channelClosed){e.next=23;break}return c(),e.abrupt("return",t.restoreReplFileGeneration({repl:n,filePath:i,generation:a}));case 23:return f.ok||(c(),t.throwRestoreError(f.error)),d=l.openChannel({service:"snapshot"}),e.next=27,d.request({hasCap:!1});case 27:if(!(p=e.sent).channelClosed){e.next=31;break}return c(),e.abrupt("return",t.restoreReplFileGeneration({repl:n,filePath:i,generation:a}));case 31:if(p.hasCap){e.next=34;break}return c(),e.abrupt("return",null);case 34:return e.next=36,d.request({fsSnapshot:{}});case 36:if(!(h=e.sent).channelClosed){e.next=40;break}return c(),e.abrupt("return",t.restoreReplFileGeneration({repl:n,filePath:i,generation:a}));case 40:return h.ok||(c(),t.throwRestoreError(h.error)),c(),e.abrupt("return",null);case 43:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()),pe(le(e),"handleSelectFile",(function(t){return e.setState({selectedFileName:t,diff:""}),e.props.fetchReplFileRevisionDays({filePath:e.getSelectedFilePath(t)}).catch((function(r){throw e.showError("Failed to load revisions for "+t),r}))})),pe(le(e),"handleExpandDay",(function(t){var r=t.slice(0,10);return e.props.fetchAllFileRevisionDay({filePath:e.getSelectedFilePath(e.state.selectedFileName),day:r}).catch((function(t){throw e.showError("Failed to load revisions for "+r),t}))})),pe(le(e),"handleSelectRevision",(function(t){if(t!==e.state.selectedRevision){var r=e.getSelectedFilePath(e.state.selectedFileName),n=(0,w.LK)("/data/repls/".concat(p(r),"/diff/").concat(t.generation)).then((function(t){e.state.diffPromise===n&&e.setState({diffPromise:null,diff:t})}),(function(t){if(e.state.diffPromise===n)if("binary"!==t.message){if("files too big"!==t.message&&"Response timeout"!==t.message)throw e.setState({diffPromise:null}),e.showError("Failed to get diff for "+r),t;e.setState({diff:"files too big",diffPromise:null})}else e.setState({diff:"binary",diffPromise:null})}));e.setState({selectedRevision:t,diffPromise:n,diff:""})}}));var r=le(e);return pe(le(e),"handleRestore",ue(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({modalName:"restoreLoading"}),t=r.state.selectedRevision?r.state.selectedRevision.generation:"",e.prev=2,e.next=5,r.restoreReplFileGeneration({repl:r.props.repl,filePath:r.state.selectedFileName,generation:t});case 5:e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(2),r.setState({modalName:"hidden"}),r.showError("Failed to restore file "+r.state.selectedFileName),e.t0;case 12:return e.prev=12,e.next=15,r.props.fetchReplFileRevisionDays({filePath:r.getSelectedFilePath(r.state.selectedFileName),force:!0});case 15:e.next=22;break;case 17:throw e.prev=17,e.t1=e.catch(12),r.setState({modalName:"hidden"}),r.showError("Failed to load file history for "+r.state.selectedFileName),e.t1;case 22:r.setState({modalName:"restoreSuccess",selectedRevision:null,diff:""});case 23:case"end":return e.stop()}}),e,null,[[2,7],[12,17]])})))),pe(le(e),"handleShowRestoreModal",(function(){e.setState({modalName:"restorePrompt"})})),pe(le(e),"getSelectedFilePath",(function(t){return"".concat(e.props.repl.id,"/").concat(t)})),pe(le(e),"hideModal",(function(){return e.setState({modalName:"hidden"})})),pe(le(e),"showError",(function(t){e.props.showMessage({content:t,type:"error",time:4e3})})),pe(le(e),"renderModal",(function(){return{hidden:null,restorePrompt:(0,a.tZ)(j.Z,{isOpen:!0,onRequestClose:e.hideModal,children:(0,a.BX)(P.Z,{onCancel:function(){return e.setState({modalName:"hidden"})},onSubmit:e.handleRestore,submitLabel:"Restore",deleteStyle:!0,children:[(0,a.BX)("div",{children:[e.state.selectedFileName," Restore revision"]}),(0,a.tZ)("div",{children:"Are you sure you want to restore this revision?"})]})}),restoreSuccess:(0,a.tZ)(j.Z,{isOpen:!0,onRequestClose:e.hideModal,children:(0,a.BX)(P.Z,{onSubmit:function(){return e.setState({modalName:"hidden"})},hideCancel:!0,children:[(0,a.tZ)("div",{children:"Restore successful"}),(0,a.BX)("div",{children:["Revision successfully restored. ",(0,a.tZ)("br",{}),"If you want to undo this, just restore the revision before last"]})]})}),restoreLoading:(0,a.tZ)(j.Z,{isOpen:!0,preventClose:!0,onRequestClose:e.hideModal,children:(0,a.BX)(b.Fragment,{children:[(0,a.tZ)(l(),{id:"febb60ea8d15292c",children:".ReplHistory__wait-modal.jsx-febb60ea8d15292c{padding:50px}"}),(0,a.tZ)("div",{className:"jsx-febb60ea8d15292c ReplHistory__wait-modal",children:"Restoring your revision, please wait"})]})})}[e.state.modalName]})),e}return t=s,n=[{key:"getInitialProps",value:function(e){var t=e.req,r=e.res,n=e.pathname,i=e.query,a=e.store,s=e.asPath;return ue(o().mark((function e(){var l,c,u,f,d,p,h,y,m,b,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.Ug)({req:t});case 2:return l=e.sent,e.next=5,(0,Q.Z)(t,a);case 5:if(c=e.sent,u=c.user,f=c.error,u){e.next=11;break}return r?(r.redirect(302,ie()(ge(),s)),r.writableEnded=!0):x.default.replace({pathname:"/login",query:{goto:s}}),e.abrupt("return",{});case 11:return d=s.split("/")[1],e.next=14,l("/data/repls/".concat(d,"/").concat(i.slug));case 14:return p=e.sent,e.next=17,p.json();case 17:if(h=e.sent,200===p.status){e.next=21;break}return r&&(r.statusCode=p.status),e.abrupt("return",{error:h});case 21:return a.dispatch((0,J.h$)(h)),y=te().getMainFileName(h.language),m=h.fileNames.filter((function(e){return!e.startsWith(".")&&!te().isLangFileBinary(h.language,e)})),b=m.find((function(e){return e===y}))||h.fileNames[0],v="".concat(h.id,"/").concat(b),e.next=28,a.dispatch(W({filePath:v,ssrFetch:l}));case 28:return e.abrupt("return",{location:n,error:f,replUrl:h.url,initialFileName:b,user:u});case 29:case"end":return e.stop()}}),e)})))()}}],(r=[{key:"render",value:function(){return this.props.error?(0,a.tZ)(v,{statusCode:this.props.error.status,message:this.props.error.message}):(0,a.BX)(E.Z,{title:this.props.repl.title+" history",description:"repls dashboard",location:this.props.location,background:1,noFooter:!0,children:[this.renderModal(),(0,a.BX)("div",{className:"jsx-6de6dbf8c4499854 ReplHistory__container",children:[(0,a.tZ)(l(),{id:"6de6dbf8c4499854",children:".ReplHistory__container.jsx-6de6dbf8c4499854{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:-webkit-calc(100vh - 60px);height:-moz-calc(100vh - 60px);height:calc(100vh - 60px);color:var(--foreground-default)}.ReplHistory__diff.jsx-6de6dbf8c4499854{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;overflow:auto}.ReplHistory__sideBar.jsx-6de6dbf8c4499854{-webkit-flex:0 0 300px;-ms-flex:0 0 300px;flex:0 0 300px;border-right:1px solid#ccc;overflow:auto}"}),(0,a.tZ)("div",{className:"jsx-6de6dbf8c4499854 ReplHistory__sideBar",children:(0,a.tZ)(G,{repl:this.props.repl,selectedFileName:this.state.selectedFileName,selectedRevisionGen:this.state.selectedRevision?this.state.selectedRevision.generation:"",onSelectFile:this.handleSelectFile,onSelectRevision:this.handleSelectRevision,onExpandDay:this.handleExpandDay})}),(0,a.tZ)("div",{className:"jsx-6de6dbf8c4499854 ReplHistory__diff",children:this.state.diffPromise?(0,a.tZ)(R.Z,{style:{margin:"25px auto"}}):(0,a.tZ)(xe,{repl:this.props.repl,diff:this.state.diff,onShowRestoreModal:this.handleShowRestoreModal,selectedFileName:this.state.selectedFileName})})]})]})}}])&&de(t.prototype,r),n&&de(t,n),s}(b.Component),Re=(0,S.$j)((function(e,t){return{repl:e.repls.data[e.replsByUrl[t.replUrl]]}}),(function(e){return(0,_.DE)({fetchReplFileRevisionDays:W,fetchAllFileRevisionDay:$,showMessage:K.P},e)}))(Ee)},69824:function(e){"use strict";e.exports=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i="",o=0;o<e.length;o++){var a=e[o],s=r[o];i+=a,s&&(i+=encodeURIComponent(s))}return i}},77020:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[5762,8350,2240,4012,2489,9998,5930,6567,2298,9774,2888,179],(function(){return t(60964),t(15938)}));var r=e.O();_N_E=r}]);
//# sourceMappingURL=replHistory-dcb792da5f1edb2a.js.map