var dependencies=["orb/features/masthead/_layoutprimarynav","orb/features/_drawerManager"];require(dependencies,function(){"use strict";for(var e=0,t=arguments.length;e<t;e++)arguments[e]()}),define("orb/lib/_event",function(){"use strict";var o={};return document.addEventListener?o.addEvent=function(e,t,n){if(e&&(e.nodeName||e===window))e.addEventListener(t,n,!1);else if(e&&e.length)for(var i=0,r=e.length;i<r;i++)o.addEvent(e[i],t,n)}:o.addEvent=function(t,e,n){if(t&&(t.nodeName||t===window))t.attachEvent("on"+e,function(e){return(e=e||window.event||{}).srcElement&&void 0===e.target&&(e.target=e.srcElement),n.call(t,e)});else if(t&&t.length)for(var i=0,r=t.length;i<r;i++)o.addEvent(t[i],e,n)},o.mixin=function(t){t.__events={},t.event=function(e){var i=void 0!==t.__events[e]?t.__events[e]:t.__events[e]=[];return{add:function(e){i.push(e)},fire:function(e){e=e||{};for(var t=0,n=i.length;t<n;t++)i[t](e)}}}},o}),define("orb/features/masthead/_drawer",[],function(){"use strict";function e(e){this.content=e,this._currentPanel=null,this.panels={},this.panelName=null}return e.prototype.addPanel=function(e){return(this.panels[e.name]=e).drawer=this},e.prototype.getPanel=function(e){return e?this.panels[e]:this._currentPanel},e.prototype.resize=function(e){this._currentPanel&&this._currentPanel.name===e&&(e=this.panels[e].content.offsetHeight+"px",document.getElementById("orb-panels").style.height=e)},e.prototype.showPanel=function(e){var t=this._currentPanel;null===t?(this.panelName=e,this.content.dispatchEvent(new CustomEvent("onActivate")),document.getElementById("orb-header").dispatchEvent(new CustomEvent("orb-drawer-open")),this._currentPanel=this.panels[e],this._currentPanel.publishState("shown")):t&&t.name===e?this.hidePanel():(this.deactivatedPanelName=this._currentPanel.name,this._currentPanel.publishState("hidden"),this.panelName=e,this._currentPanel=this.panels[e],this.content.dispatchEvent(new CustomEvent("onSwapContents")),this._currentPanel.publishState("shown"))},e.prototype.hidePanel=function(){var e=this._currentPanel;null!==e&&(this.content.dispatchEvent(new CustomEvent("onDeactivate")),e.publishState("hidden"),this.panelName=null,this._currentPanel=null)},e.prototype.activate=function(){this._currentPanel&&this.showPanel(this._currentPanel.name)},e.prototype.deactivate=function(){this.hidePanel()},e.prototype.getCurrentPanel=function(){return this._currentPanel},e.Panel=function(e,t,n){this.name=e,t&&(this.control=t.control,this.content=t.content),this.publishState=function(e){"function"==typeof this.stateChangeCallback&&this.stateChangeCallback.call(null,e)},"function"==typeof n&&(this.stateChangeCallback=n)},e}),define("orb/features/masthead/_layoutprimarynav",["orb/lib/_event","orb/api","orb/features/masthead/_linkmanager","orb/features/_moreDrawer"],function(e,y,g,w){"use strict";function k(){var e=document.querySelectorAll(".orb-nav-links li"),e=Array.prototype.slice.call(e),o=new g(e.slice(0,-1)),n=!1,r=document.querySelector(".orb-nav-search"),a=document.getElementById("orb-nav-more"),s=document.getElementById("orb-header"),l=document.querySelector(".orb-nav-pri-container"),t="orb-nav-lock",d=1,u=a.querySelector("a"),c=u.firstChild.data,f=u.getAttribute("data-alt");function i(){var e=k.event("beforeLayout"),t=k.event("afterLayout"),n={links:o.links},i=l.offsetTop;e.fire(n),a.classList.add("orb-nav-hide"),o.showAll();e=o.getLastItem();r.offsetTop===i&&e&&e.offsetTop===i||(function(){var e,t;a.classList.remove("orb-nav-hide");var n=u.getAttribute("style");a.style.width="auto",u.style.textIndent="0",u.firstChild.data=f,e=a.offsetWidth,u.firstChild.data=c,t=a.offsetWidth,t=Math.max(e,t),a.style.width=t+"px",n?u.setAttribute("style",n):u.removeAttribute("style")}(),o.hideToFit(function(e){if(a.offsetTop!==i||r.offsetTop!==i)return!0},d)),function(){if(void 0!==document.querySelector("#homepage-link").dataset.vGroup){var i=document.querySelectorAll("#orb-nav-links li").length-document.querySelectorAll("#orb-nav-links li.orb-nav-hide").length-1;let t=JSON.parse(document.querySelector("#homepage-link").dataset.vGroup);t.type=t.type.split("-").slice(0,2).join("-")+"-"+i,document.querySelector("#homepage-link").setAttribute("data-v-group",JSON.stringify(t));let n=document.querySelectorAll(".orb-nav-links ul li");for(let e=0;e<i;e++){var r={position:e+3,type:"priority-link"};n[e].setAttribute("data-v-group",JSON.stringify(t)),n[e].setAttribute("data-v-item",JSON.stringify(r)),n[e].setAttribute("data-bbc-ignore-views",1)}}}(),t.fire(n)}function h(){l.classList.add(t)}function v(){l.classList.remove(t),y.trigger("layout",{width:l.offsetWidth,height:l.offsetHeight})}function m(){var e,t=0;return function(){window.innerWidth!==t&&(t=window.innerWidth,h(),e&&clearTimeout(e),e=setTimeout(function(){i(),w.layoutMorePanelContent(),v()},100))}}function p(){var e={isNull:!0,offsetLeft:-1,offsetWidth:0},t=document.querySelector(".orb-nav-search")||e,n=document.getElementById("orb-nav-links")||e,i=document.getElementById("orb-nav-more")||e,r=0,e=void 0===s.getAttribute("dir");r=e?function(){return i.offsetLeft-(t.offsetLeft+t.offsetWidth)}:function(){return t.offsetLeft-n.offsetLeft-n.offsetWidth},k.event("afterLayout").add(function(e){i.style.width=i.offsetWidth+r()-3+"px"})}function b(e){window.orb&&!e&&function(){var e=document.querySelectorAll(".orb-nav-links ul li"),t=window.orb.worldwideNavlinks;if(t){for(var n=0,i=e.length;n<i;n++){var r=e[n];"orb-nav-more"!==r.id&&r.parentNode.removeChild(r)}document.getElementById("orb-nav-more").insertAdjacentHTML("beforebegin",t)}t=document.querySelectorAll(".orb-nav-links li"),t=Array.prototype.slice.call(t),o=new g(t.slice(0,-1))}();var t=e?s.getAttribute("data-max-d"):s.getAttribute("data-max-w");null!==t&&o.applyMaximum(t),k.event("afterLayout").add(function(e){o.hasVisible()?u.firstChild.data=f:u.firstChild.data=c}),p(),h(),s.classList.add("orb-nav-dyn"),s.classList.remove("orb-nav-empty"),i(),v(),n=!0,!e&&window.orb.worldwideNavlinks?w(window.orb.worldwideNavlinks):w(document.getElementById("orb-aside").querySelectorAll(".orb-footer-primary-links ul")[0].innerHTML),window.addEventListener("resize",m()),window.addEventListener("orientationchange",function(){setTimeout(m(),100)}),new MutationObserver(function(e,t){e.forEach(function(e){"childList"===e.type&&k.recalculateLayout()})}).observe(document.getElementById("orb-panels"),{childList:!0})}k.recalculateLayout=function(){n&&(h(),i(),w.layoutMorePanelContent(),p(),v())},window.bbcuser.isUKCombined().then(b).catch(function(){b(!0)})}return e.mixin(k),k}),define("orb/features/masthead/_linkmanager",[],function(){"use strict";function e(e){if(void 0!==this.links)for(var t=0,n=this.links.length;t<n;t++)e(this.links[t],t)}var r="orb-nav-hide",t=function(e){this.links=[];for(var t=0,n=e.length;t<n;t++){this.links[t]=e[t];var i=(this.links[t].innerText||this.links[t].textContent).trim();this.links[t].linktrack={nav_link:i}}};return t.prototype.removeLink=function(e){this.links[e].parentNode.removeChild(this.links[e]),delete this.links[e]},t.prototype.showAll=function(){e.call(this,function(e){e.classList.remove(r)})},t.prototype.hideToFit=function(e,t){for(var n=!1,i=this.links.length;i--;)if(n||e())this.links[i].classList.add(r);else{if(!(i<t-1))break;n=!0,i++}},t.prototype.applyMaximum=function(n){var i=this;e.call(this,function(e,t){n<=t&&i.removeLink(t)});var t=[];e.call(this,function(e){e&&t.push(e)}),this.links=t},t.prototype.hasVisible=function(){return this.links[0]&&-1===this.links[0].className.indexOf(r)},t.prototype.getLastItem=function(){return this.links.length?this.links[this.links.length-1]:null},t}),define("orb/features/_moreDrawer",["orb/nav"],function(u){var t=document.getElementById("orb-nav-more"),c="orb-first-visible",n=document.createElement("div");function i(){for(var e=document.querySelectorAll(".orb-nav-links li"),t=document.querySelectorAll("#orb-panel-more li"),n=document.querySelectorAll(".orb-panel-content ."+c),i="orb-panel-hide",r=0,o=u.getMastheadDrawer(),a=0,s=e.length;a<s-1&&-1===e[a].className.indexOf("orb-nav-hide");a++)r++;for(var l=0,d=t.length;l<d;l++)l<r?t[l].classList.add(i):t[l].classList.remove(i);n&&n.length&&n[0].classList.remove(c),r<t.length?t[r].classList.add(c):r!==t.length||(n=o.getCurrentPanel())&&"more"===n.name&&o.hidePanel(),document.getElementById("orb-panel-more-title").innerHTML=document.querySelector("#orb-nav-more a").innerHTML}function e(e){u.addDrawer("more",t,n),n.innerHTML='<div class="orb-panel-content b-g-p b-r orb-nav-sec"><h2 id="orb-panel-more-title"></h2><ul>'+e+"</ul></div>",i(),document.documentElement.classList.add("orb-more-loaded")}return n.setAttribute("id","orb-panel-more"),n.classList.add("orb-panel"),e.layoutMorePanelContent=i,e}),define("orb/features/_drawerManager",["orb/features/masthead/_drawer"],function(e){"use strict";var i=document.getElementById("orb-panels"),o=new e(i),a=document.getElementById("orb-header"),s="orb-nav-focus-on",l="orb-panel-active",d="orb-nav-active";function t(){function r(i,e){var r,o=parseFloat(i.offsetHeight),a=e.height,s=e.duration,l=i.style,d=(new Date).getTime();return clearTimeout(i.orbAnimTimer),new Promise(function(n,e){0===s?(l.height=a+"px",n()):(r=function(){var e,t=(new Date).getTime()-d,e=(e=t,-(a-o)*(e/=s)*(e-2)+o);if(s<t)return l.height=a+"px",void n();l.height=e+"px",i.orbAnimTimer=setTimeout(r,10)},i.orbAnimTimer=setTimeout(r,0))})}function e(){a.drawer=o;var e=a.querySelector("#orb-panels");e.addEventListener("onActivate",function(){!function(e){if(e){a.classList.add(d),e.control.classList.add(s);var t=e.content;t.style.display="block";var n=t.offsetHeight,i=o.content;if(i.style.height="0px",i.setAttribute("aria-expanded","true"),i.classList.add(l),"mouse"===a.navMode)return r(i,{height:n,duration:400}).then(function(){i.style.display="inline"}),t.setAttribute("tabindex","-1"),t.focus();i.style.display="inline";e=e.content.querySelector(".orb-first-visible a",e.content)||e.content.querySelector(".orb-first-target");e&&e.focus()}}(o.getPanel(o.panelName))}),e.addEventListener("onDeactivate",function(){!function(e){if(e){a.classList.remove(d),e.control.classList.remove(s);var t=e.content,n=t.offsetHeight+"px",i=o.content;if(i.style.display="block",i.style.height=n,i.classList.remove(l),i.setAttribute("aria-expanded","false"),"mouse"===a.navMode)return r(i,{height:0,duration:400}).then(function(){t.style.display="none"}),e.content.setAttribute("tabindex","-1"),e.content.focus();i.style.height="0px",t.style.display="none"}}(o.getPanel())}),e.addEventListener("onSwapContents",function(){!function(e,t){e.control.classList.remove(s),t.control.classList.add(s);var n=e.content,e=n.offsetHeight+"px",i=o.content;if(i.style.height=e,i.style.display="block",n.style.display="none",(e=t.content).style.display="block",n=e.offsetHeight,"mouse"===a.navMode)return r(i,{height:n,duration:400}).then(function(){i.style.display="inline"}),e.setAttribute("tabindex","-1"),e.focus();i.style.display="inline",linkToFocus=t.content.querySelector(".orb-first-visible a"),linkToFocus&&linkToFocus.focus()}(o.panels[o.deactivatedPanelName],o.getPanel())}),a.addEventListener("mousemove",function(e){a.navMode="mouse"}),a.addEventListener("mousedown",function(e){a.navMode="mouse"}),a.addEventListener("keydown",function(e){a.navMode="keyboard"})}"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}return t.addPanelEvents=function(t){var n=t.name;t.control.addEventListener("click",function(e){return o.showPanel(n),e.preventDefault?e.preventDefault():e.returnValue=!1,!1}),i.addEventListener("keydown",function(e){27===("number"==typeof e.which?e.which:e.keyCode)&&(o.hidePanel(n),(e=t.control.querySelector("a"))&&e.focus())})},t.getMastheadDrawer=function(){return o},t}),define("orb/nav",["orb/features/_drawerManager","orb/features/masthead/_drawer"],function(r,o){"use strict";var e={init:function(){r()},loadCss:function(e,t){window.bbcpage.loadCSS(e).then(function(){"function"==typeof t&&t()})},loadJs:function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!0,document.getElementsByTagName("body")[0].appendChild(t)},addDrawer:function(e,t,n,i){document.getElementById("orb-panels").appendChild(n);i=new o.Panel(e,{control:t,content:n},i);r.getMastheadDrawer().addPanel(i),r.addPanelEvents(i)},getDrawerState:function(e){var t=r.getMastheadDrawer().getCurrentPanel();return null===t||t.name!=e?"hidden":"shown"},updateDrawerHeight:function(e){},getMastheadDrawer:function(){return r.getMastheadDrawer()},refresh:function(){}};return document.getElementById("orb-header").addEventListener("orbit-drawer-open",function(){r.getMastheadDrawer().hidePanel()}),e});
//# sourceMappingURL=orb.min.js.map
